{"version":3,"sources":["../../src/pages/editprofile/editprofile.module.ts","../../src/pages/editprofile/editprofile.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { EditProfilePage } from './editprofile';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    EditProfilePage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(EditProfilePage),\r\n  ],\r\n})\r\nexport class EditProfilePageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/editprofile/editprofile.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, AlertController } from 'ionic-angular';\r\nimport { AngularFireAuth } from \"angularfire2/auth\";\r\nimport { AngularFireDatabase, FirebaseObjectObservable } from 'angularfire2/database';\r\nimport { UserInfo } from \"../../model/user\";\r\nimport { FormGroup, FormBuilder, Validators } from \"@angular/forms\";\r\nimport { RequestOptions, Http, Headers } from \"@angular/http\";\r\nimport { ProfilePage } from \"../profile/profile\";\r\nimport { HttpServiceProvider } from \"../../providers/http-service/http-service\";\r\n\r\n/**\r\n * Generated class for the EditprofilePage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-editprofile',\r\n  templateUrl: 'editprofile.html',\r\n})\r\nexport class EditProfilePage {\r\n  userInfo = {} as UserInfo;\r\n  profileData: FirebaseObjectObservable<UserInfo>;\r\n  loading; \r\n  editForm: FormGroup;\r\n  uid: string;\r\n  private apiUrl = 'http://115.146.86.193:8080/';\r\n  result:String;\r\n  streetname: string;\r\n  streetnumber: string;\r\n  suburb: string;\r\n  state: string;\r\n  postcode: string;\r\n  country: string;\r\n\r\n  constructor(public navCtrl: NavController,\r\n    public navParams: NavParams,\r\n    private afAuth: AngularFireAuth,\r\n    private db: AngularFireDatabase,\r\n    private alertCtrl: AlertController,\r\n    private builder: FormBuilder,\r\n    private http: Http,\r\n    private httpProviders : HttpServiceProvider) {\r\n\r\n    /*this.db.list(`users/${data.uid}`).subscribe(snapshots =>{\r\n       console.log (\"snapshots=\" +snapshots);\r\n       console.log(\"value = \"+ snapshots.values);\r\n       /*snapshots.forEach(snapshot=>{\r\n         console.log(\" key = \"+Object.values());\r\n         //this.profileData.push(Object.keys(snapshot));\r\n       });*/\r\n    //console.log(\"ProfileData = \"+ this.profileData);\r\n    /*snapshots.forEach(snapshot=>{\r\n      //console.log(\"snapshot = \"+snapshot.key()) ;\r\n      snapshot.array.forEach(element => {\r\n        console.log(element);\r\n      });\r\n      //console.log(snapshot.val());\r\n      //this.profileData = snapshot.val();\r\n    })*/\r\n    this.afAuth.authState.subscribe(data => {\r\n      this.uid = data.uid;\r\n      console.log(\"uid = \" + this.uid);\r\n      this.profileData = this.db.object(`users/` + this.uid/*,{preserveSnapshot: true}*/);\r\n      this.profileData.forEach(snapshot => {\r\n\r\n        this.streetname = snapshot.streetname;\r\n        this.streetnumber = snapshot.streetnumber;\r\n        this.suburb = snapshot.suburb;\r\n        this.state = snapshot.state;\r\n        this.postcode = snapshot.postcode;\r\n        this.country = snapshot.country;\r\n\r\n        this.editForm = builder.group({\r\n          'auth': [],\r\n          'first-name': [snapshot.firstname],\r\n          'last-name': [snapshot.lastname],\r\n          'dob': [snapshot.dob],\r\n          'streetname': [snapshot.streetname],\r\n          'streetnumber': [snapshot.streetnumber],\r\n          'suburb': [snapshot.suburb],\r\n          'state': [snapshot.state],\r\n          'postcode': [snapshot.postcode],\r\n          'country': [snapshot.country]\r\n          /*console.log (\"snapshots=\" +snapshots);\r\n          console.log(\"value = \"+ snapshots.values);\r\n          snapshots.forEach(snapshot=>{\r\n            console.log(\"snapshot = \"+snapshot.key+\", values =\" + snapshot.val()) ;\r\n          });*/\r\n        });\r\n      })\r\n\r\n      console.log(this.profileData);\r\n    });\r\n  }\r\n\r\n  async update(){\r\n  \r\n    if(this.validate()){\r\n      this.userInfo.userid = this.uid;\r\n        if(this.userInfo.streetname!= null || this.userInfo.streetnumber!= null|| \r\n          this.userInfo.suburb!= null|| this.userInfo.state!= null\r\n          || this.userInfo.postcode!= null || this.userInfo.country!= null){\r\n            console.log(\"this.userInfo.streetname\")\r\n\r\n          if(this.userInfo.streetname == null){\r\n            this.userInfo.streetname = this.streetname;\r\n            console.log(\"this.userInfo.streetname\");\r\n          }\r\n          if(this.userInfo.streetnumber == null){\r\n            this.userInfo.streetnumber = this.streetnumber;\r\n          }\r\n          if(this.userInfo.suburb == null){\r\n            this.userInfo.suburb = this.suburb;\r\n            console.log(\"this.userInfo.suburb\");\r\n          }\r\n          if(this.userInfo.state == null){\r\n            this.userInfo.state = this.state;\r\n          }\r\n          if(this.userInfo.postcode == null){\r\n            this.userInfo.postcode = this.postcode;\r\n          }          \r\n          if(this.userInfo.country == null){\r\n            this.userInfo.country = this.country;\r\n          }\r\n        }\r\n         \r\n      this.httpProviders.httpPost(this.apiUrl+\"profileUpdate\",JSON.stringify(this.userInfo))\r\n      .then(result=>{\r\n        console.log(\"get result here\");\r\n        var res = result.response;\r\n        if(res ==\"success\"){\r\n          console.log(\"get result here\");\r\n          this.navCtrl.pop();//.catch(() => console.log('view was not poped'));;\r\n        }\r\n      }).catch(err=>{\r\n        console.log(\"catching error here\");\r\n        let alert = this.alertCtrl.create({\r\n          title: 'Error',\r\n          message : err,\r\n          buttons : ['OK']\r\n        });\r\n        alert.present();\r\n      })\r\n      \r\n    }\r\n  }\r\n  \r\n\r\n  validate(): boolean {\r\n    // figure out the error message\r\n    let errorMsg = '';\r\n/*\r\n    // validate each field\r\n    let control = this.editForm.controls['email'];\r\n    if (!control.valid) {\r\n      if (control.errors['required']) {\r\n        errorMsg = 'Email cannot be empty';\r\n      } else if (control.errors['minlength']) {\r\n        errorMsg = 'Email must at least be 5 characters';\r\n      } else if (control.errors['email']) {\r\n        errorMsg = \"Not a valid email format\";\r\n      }\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }\r\n\r\n    control = this.editForm.controls['password'];\r\n    if (!control.valid) {\r\n      if (control.errors['required']) {\r\n        errorMsg = 'Password cannot be empty';\r\n      } else if (control.errors['minlength']) {\r\n        errorMsg = 'Password must have at least 8 characters';\r\n      }\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }*/\r\n\r\n    let control = this.editForm.controls['first-name'];\r\n    if (!control.valid) {\r\n      if (control.errors['required']) {\r\n        errorMsg = 'First name cannot be empty';\r\n      }\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }\r\n\r\n/*\r\n    control = this.editForm.controls['auth'];\r\n    if (!control.valid) {\r\n      errorMsg = \"auth error\";\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }\r\n    */\r\n    control = this.editForm.controls['last-name'];\r\n    if (!control.valid) {\r\n      if (control.errors['required']) {\r\n        errorMsg = 'Last name cannot be empty';\r\n      }\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }\r\n\r\n    control = this.editForm.controls['dob'];\r\n    if (!control.valid) {\r\n      if (control.errors['required']) {\r\n        errorMsg = 'Date cannot be empty';\r\n      }\r\n      this.createAlert(errorMsg);\r\n      return false;\r\n    }\r\n\r\n\r\n    return true;\r\n\r\n  }\r\n\r\n  createAlert(msg: string) {\r\n    let alert = this.alertCtrl.create({\r\n      message: msg,\r\n      buttons: ['OK']\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  \r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/editprofile/editprofile.ts"],"sourceRoot":""}